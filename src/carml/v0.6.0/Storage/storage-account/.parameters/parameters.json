{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
      "name": {
        "value": "ssamax001"
      },
      "allowBlobPublicAccess": {
        "value": false
      },
      "blobServices": {
        "value": {
          "automaticSnapshotPolicyEnabled": true,
          "containerDeleteRetentionPolicyDays": 10,
          "containerDeleteRetentionPolicyEnabled": true,
          "containers": [
            {
              "enableNfsV3AllSquash": true,
              "enableNfsV3RootSquash": true,
              "name": "avdscripts",
              "publicAccess": "None",
              "roleAssignments": [
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "Owner"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "b24988ac-6180-42a0-ab88-20f7382dd24c"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "<roleDefinitionIdOrName>"
                }
              ]
            },
            {
              "allowProtectedAppendWrites": false,
              "enableWORM": true,
              "metadata": {
                "testKey": "testValue"
              },
              "name": "archivecontainer",
              "publicAccess": "None",
              "WORMRetention": 666
            }
          ],
          "deleteRetentionPolicyDays": 9,
          "deleteRetentionPolicyEnabled": true,
          "diagnosticSettings": [
            {
              "eventHubAuthorizationRuleResourceId": "<eventHubAuthorizationRuleResourceId>",
              "eventHubName": "<eventHubName>",
              "metricCategories": [
                {
                  "category": "AllMetrics"
                }
              ],
              "name": "customSetting",
              "storageAccountResourceId": "<storageAccountResourceId>",
              "workspaceResourceId": "<workspaceResourceId>"
            }
          ],
          "lastAccessTimeTrackingPolicyEnabled": true
        }
      },
      "diagnosticSettings": {
        "value": [
          {
            "eventHubAuthorizationRuleResourceId": "<eventHubAuthorizationRuleResourceId>",
            "eventHubName": "<eventHubName>",
            "metricCategories": [
              {
                "category": "AllMetrics"
              }
            ],
            "name": "customSetting",
            "storageAccountResourceId": "<storageAccountResourceId>",
            "workspaceResourceId": "<workspaceResourceId>"
          }
        ]
      },
      "enableDefaultTelemetry": {
        "value": "<enableDefaultTelemetry>"
      },
      "enableHierarchicalNamespace": {
        "value": true
      },
      "enableNfsV3": {
        "value": true
      },
      "enableSftp": {
        "value": true
      },
      "fileServices": {
        "value": {
          "diagnosticSettings": [
            {
              "eventHubAuthorizationRuleResourceId": "<eventHubAuthorizationRuleResourceId>",
              "eventHubName": "<eventHubName>",
              "metricCategories": [
                {
                  "category": "AllMetrics"
                }
              ],
              "name": "customSetting",
              "storageAccountResourceId": "<storageAccountResourceId>",
              "workspaceResourceId": "<workspaceResourceId>"
            }
          ],
          "shares": [
            {
              "accessTier": "Hot",
              "name": "avdprofiles",
              "roleAssignments": [
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "Owner"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "b24988ac-6180-42a0-ab88-20f7382dd24c"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "<roleDefinitionIdOrName>"
                }
              ],
              "shareQuota": 5120
            },
            {
              "name": "avdprofiles2",
              "shareQuota": 102400
            }
          ]
        }
      },
      "largeFileSharesState": {
        "value": "Enabled"
      },
      "localUsers": {
        "value": [
          {
            "hasSharedKey": false,
            "hasSshKey": true,
            "hasSshPassword": false,
            "homeDirectory": "avdscripts",
            "name": "testuser",
            "permissionScopes": [
              {
                "permissions": "r",
                "resourceName": "avdscripts",
                "service": "blob"
              }
            ],
            "storageAccountName": "ssamax001"
          }
        ]
      },
      "lock": {
        "value": {
          "kind": "CanNotDelete",
          "name": "myCustomLockName"
        }
      },
      "managedIdentities": {
        "value": {
          "systemAssigned": true,
          "userAssignedResourceIds": [
            "<managedIdentityResourceId>"
          ]
        }
      },
      "managementPolicyRules": {
        "value": [
          {
            "definition": {
              "actions": {
                "baseBlob": {
                  "delete": {
                    "daysAfterModificationGreaterThan": 30
                  },
                  "tierToCool": {
                    "daysAfterLastAccessTimeGreaterThan": 5
                  }
                }
              },
              "filters": {
                "blobIndexMatch": [
                  {
                    "name": "BlobIndex",
                    "op": "==",
                    "value": "1"
                  }
                ],
                "blobTypes": [
                  "blockBlob"
                ],
                "prefixMatch": [
                  "sample-container/log"
                ]
              }
            },
            "enabled": true,
            "name": "FirstRule",
            "type": "Lifecycle"
          }
        ]
      },
      "networkAcls": {
        "value": {
          "bypass": "AzureServices",
          "defaultAction": "Deny",
          "ipRules": [
            {
              "action": "Allow",
              "value": "1.1.1.1"
            }
          ],
          "virtualNetworkRules": [
            {
              "action": "Allow",
              "id": "<id>"
            }
          ]
        }
      },
      "privateEndpoints": {
        "value": [
          {
            "privateDnsZoneResourceIds": [
              "<privateDNSZoneResourceId>"
            ],
            "service": "blob",
            "subnetResourceId": "<subnetResourceId>",
            "tags": {
              "Environment": "Non-Prod",
              "hidden-title": "This is visible in the resource name",
              "Role": "DeploymentValidation"
            }
          }
        ]
      },
      "queueServices": {
        "value": {
          "diagnosticSettings": [
            {
              "eventHubAuthorizationRuleResourceId": "<eventHubAuthorizationRuleResourceId>",
              "eventHubName": "<eventHubName>",
              "metricCategories": [
                {
                  "category": "AllMetrics"
                }
              ],
              "name": "customSetting",
              "storageAccountResourceId": "<storageAccountResourceId>",
              "workspaceResourceId": "<workspaceResourceId>"
            }
          ],
          "queues": [
            {
              "metadata": {
                "key1": "value1",
                "key2": "value2"
              },
              "name": "queue1",
              "roleAssignments": [
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "Owner"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "b24988ac-6180-42a0-ab88-20f7382dd24c"
                },
                {
                  "principalId": "<principalId>",
                  "principalType": "ServicePrincipal",
                  "roleDefinitionIdOrName": "<roleDefinitionIdOrName>"
                }
              ]
            },
            {
              "metadata": {},
              "name": "queue2"
            }
          ]
        }
      },
      "requireInfrastructureEncryption": {
        "value": true
      },
      "roleAssignments": {
        "value": [
          {
            "principalId": "<principalId>",
            "principalType": "ServicePrincipal",
            "roleDefinitionIdOrName": "Owner"
          },
          {
            "principalId": "<principalId>",
            "principalType": "ServicePrincipal",
            "roleDefinitionIdOrName": "b24988ac-6180-42a0-ab88-20f7382dd24c"
          },
          {
            "principalId": "<principalId>",
            "principalType": "ServicePrincipal",
            "roleDefinitionIdOrName": "<roleDefinitionIdOrName>"
          }
        ]
      },
      "sasExpirationPeriod": {
        "value": "180.00:00:00"
      },
      "skuName": {
        "value": "Standard_LRS"
      },
      "tableServices": {
        "value": {
          "diagnosticSettings": [
            {
              "eventHubAuthorizationRuleResourceId": "<eventHubAuthorizationRuleResourceId>",
              "eventHubName": "<eventHubName>",
              "metricCategories": [
                {
                  "category": "AllMetrics"
                }
              ],
              "name": "customSetting",
              "storageAccountResourceId": "<storageAccountResourceId>",
              "workspaceResourceId": "<workspaceResourceId>"
            }
          ],
          "tables": [
            "table1",
            "table2"
          ]
        }
      },
      "tags": {
        "value": {
          "Environment": "Non-Prod",
          "hidden-title": "This is visible in the resource name",
          "Role": "DeploymentValidation"
        }
      }
    }
  }